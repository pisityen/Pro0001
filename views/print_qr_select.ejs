<!DOCTYPE html>
<html>
<head>
  <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å QR ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- CSS -->
  <link rel="stylesheet" href="/css/bar.css" />
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
    <div class="main-container">
      <!-- Sidebar -->
      <div class="sidebar bg-dark text-white vh-100 d-flex flex-column" id="side_nav">
        <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô Sidebar -->
        <div class="header-box px-3 pt-3 pb-4 d-flex justify-content-between align-items-center">
          <h1 class="fs-5 text-uppercase">
            <span class="bg-white text-dark rounded shadow px-2 me-2">IT</span>
            <span class="text-white">Management</span>
          </h1>
        </div>
        <ul class="list-unstyled px-2">
          <li class="mb-2">
          <% if (role === 'admin') { %><a href="/dashboard" class="text-decoration-none px-3 py-3 d-block rounded text-white active-link">Dashboard</a><% } %>
         </li>
          <% if (role === 'admin') { %><li class="mb-2"><a href="/asset_management" class="text-decoration-none px-3 py-3 d-block rounded text-white active-link">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</a></li><% } %>
          <li class="mb-2"><a href="/asset_requests" class="text-decoration-none px-3 py-3 d-block rounded text-white active-link">‡πÄ‡∏ö‡∏¥‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</a></li>
          <li class="mb-2"><a href="/all_transfers" class="text-decoration-none px-3 py-3 d-block rounded text-white active-link">‡πÇ‡∏≠‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</a></li>
            <% if (role === 'admin') { %><a href="/account" class="text-decoration-none px-3 py-3 d-block rounded text-white active-link">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a><% } %></li>
        </ul>
        <div class="mt-auto px-2 pb-3 text-center">
          <div class="text-white mb-2">
            User : <%= user_name %>
          </div>
          <div class="text-white mb-2">
            Role : <%= role %>
          </div>
          <a href="/logout" class="btn btn-danger text-decoration-none px-3 py-2 w-100">
            <i class="fas fa-sign-out-alt me-2"></i> Logout
          </a>
        </div>
      </div>
  
        <!-- //‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å// -->
         <div class="container mt-4">
            <h2>üì¶ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå QR</h2>
            <form id="qrForm">
                <div class="form-check">
                <% assets.forEach(asset => { %>
                    <div class="mb-2">
                    <input type="checkbox" class="form-check-input" name="as_ids" value="<%= asset.as_asset_number %>">
                    <label class="form-check-label">
                        <strong><%= asset.as_asset_number %></strong> - <%= asset.as_name %> (SN: <%= asset.as_serial_number %>)
                    </label>
                    </div>
                <% }) %>
                </div>
                <button type="submit" class="btn btn-primary mt-3">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå QR</button>
            </form>
        </div>
    </div>

  <script>
    document.getElementById("qrForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const checkboxes = document.querySelectorAll('input[name="as_ids"]:checked');
      if (checkboxes.length === 0) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£");
        return;
      }

      const ids = Array.from(checkboxes).map(cb => cb.value).join(',');
      const url = `/assets/print_qr?ids=${encodeURIComponent(ids)}`;
      window.open(url, '_blank');
    });
  </script>
</body>
</html>
